[{"content":"Sherman-Morrison-Woodbury Formula Theorem Sherman-Morrison-Woodbury Formula: Given $4$ matrices $\\textbf{A} \\in \\mathbb{R}^{p\\times p},\\textbf{U} \\in \\mathbb{R}^{p\\times q},\\textbf{V} \\in \\mathbb{R}^{q\\times p},\\textbf{C} \\in \\mathbb{R}^{q\\times q}$, where $\\textbf{A},\\textbf{C}, \\begin{bmatrix} \\textbf{A} \u0026amp; \\textbf{U} \\\\ \\textbf{V} \u0026amp; \\textbf{C} \\end{bmatrix}$ are invertible. Then,\n$$(\\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V})^{-1} = \\textbf{A}^{-1} - \\textbf{A}^{-1}\\textbf{U}(\\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U})^{-1}\\textbf{V}\\textbf{A}^{-1} \\stackrel{\\Delta}{=} f(\\textbf{A},\\textbf{C},\\textbf{U},\\textbf{V})$$ Proof We can observe that\n$$\\small\\begin{aligned}\\begin{bmatrix} f(\\textbf{A},\\textbf{C},\\textbf{U},\\textbf{V}) \u0026 \\textbf{O} \\\\\\\\ ? \u0026 \\textbf{I}_q \\end{bmatrix} \u0026= \\begin{bmatrix} \\textbf{I}_p \u0026 -\\textbf{A}^{-1}\\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 (\\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U})^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{A}^{-1}\\textbf{U} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U} \\end{bmatrix} \\\\\\\\ \u0026= \\begin{bmatrix} \\textbf{I}_p \u0026 -\\textbf{A}^{-1}\\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 (\\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U})^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{O} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix}\\end{aligned}$$Multiply the four block matrices on the right to $\\begin{bmatrix}\\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V} \u0026amp; \\textbf{O} \\\\ \\textbf{O} \u0026amp; \\textbf{I}_q\\end{bmatrix}$ and derive an identity matrix at top-left, which implies that $(\\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V})f(\\textbf{A},\\textbf{C},\\textbf{U},\\textbf{V}) = \\textbf{I}_p$.\n$\\square$\nComputation Let $\\textbf{D} \\stackrel{\\Delta}{=} \\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U}$, then\n$$\\small\\begin{aligned} \u0026\\begin{bmatrix} \\textbf{A} + \\textbf{U}\\textbf{C}\\textbf{V} \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 -\\textbf{A}^{-1}\\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q\\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 (\\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U})^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{O} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\\\\\\\ =\u0026 \\begin{bmatrix}\\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V} \u0026 -\\textbf{U}-\\textbf{U}\\textbf{C}\\textbf{V}\\textbf{A}^{-1}\\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q\\end{bmatrix} \\begin{bmatrix}\\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 \\textbf{D}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{O} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\\\\\\\ =\u0026 \\begin{bmatrix} \\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V} \u0026 -\\textbf{U}\\textbf{C}\\textbf{D}\\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 \\textbf{D}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{O} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\\\\\\\ =\u0026 \\begin{bmatrix} \\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V} \u0026 -\\textbf{U}\\textbf{C} \\\\\\\\ \\textbf{O} \u0026 \\textbf{D}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{O} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\\\\\\\ =\u0026 \\begin{bmatrix} \\textbf{I}_p \u0026 -\\textbf{U} \\\\\\\\ ? \u0026 ? \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\\\textbf{O} \u0026 \\textbf{I}_q\\end{bmatrix} = \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\? \u0026 ?\\end{bmatrix} \\\\\\\\ \\Rightarrow \u0026 (\\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V})f(\\textbf{A},\\textbf{C},\\textbf{U},\\textbf{V}) = \\textbf{I}_p \\end{aligned}$$","date":"2025-03-08T00:00:00Z","image":"https://moonight3547.github.io/p/punching-hole-technique/SMW-slide_hu_6e70bc4efc46de1c.jpg","permalink":"https://moonight3547.github.io/p/punching-hole-technique/","title":"Punching Hole Technique"},{"content":"","date":"0001-01-01T00:00:00Z","permalink":"https://moonight3547.github.io/p/","title":""}]