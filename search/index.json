[{"content":"","date":"2025-03-10T00:00:00Z","permalink":"http://localhost:1313/p/first-order-method/","title":"First Order Method"},{"content":"Introduction: A Proof of SMW Formula In the tutorial of MAT2041A Linear Algebra and Applications, I constructed a proof of the Sherman-Morrison-Woodbury Formula to demonstrate the potential of block matrices.\nSherman-Morrison-Woodbury Formula Sherman-Morrison-Woodbury Formula: Given $4$ matrices $\\textbf{A} \\in \\mathbb{R}^{p\\times p},\\textbf{U} \\in \\mathbb{R}^{p\\times q},\\textbf{V} \\in \\mathbb{R}^{q\\times p},\\textbf{C} \\in \\mathbb{R}^{q\\times q}$, where $\\textbf{A},\\textbf{C}, \\begin{bmatrix} \\textbf{A} \u0026amp; \\textbf{U} \\\\ \\textbf{V} \u0026amp; \\textbf{C} \\end{bmatrix}$ are invertible. Then,\n$$(\\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V})^{-1} = \\textbf{A}^{-1} - \\textbf{A}^{-1}\\textbf{U}(\\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U})^{-1}\\textbf{V}\\textbf{A}^{-1} \\stackrel{\\Delta}{=} f(\\textbf{A},\\textbf{C},\\textbf{U},\\textbf{V})$$ Proof We can observe that\n$$\\small\\begin{aligned}\\begin{bmatrix} f(\\textbf{A},\\textbf{C},\\textbf{U},\\textbf{V}) \u0026 \\textbf{O} \\\\\\\\ ? \u0026 \\textbf{I}_q \\end{bmatrix} \u0026= \\begin{bmatrix} \\textbf{I}_p \u0026 -\\textbf{A}^{-1}\\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 (\\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U})^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{A}^{-1}\\textbf{U} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U} \\end{bmatrix} \\\\\\\\ \u0026= \\begin{bmatrix} \\textbf{I}_p \u0026 -\\textbf{A}^{-1}\\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 (\\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U})^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{O} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix}\\end{aligned}$$Multiply the four block matrices on the right to $\\begin{bmatrix}\\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V} \u0026amp; \\textbf{O} \\\\ \\textbf{O} \u0026amp; \\textbf{I}_q\\end{bmatrix}$ and derive an identity matrix at top-left, which implies that $(\\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V})f(\\textbf{A},\\textbf{C},\\textbf{U},\\textbf{V}) = \\textbf{I}_p$.\n$\\square$\nComputation Let $\\textbf{D} \\stackrel{\\Delta}{=} \\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U}$, then\n$$\\small\\begin{aligned} \u0026\\begin{bmatrix} \\textbf{A} + \\textbf{U}\\textbf{C}\\textbf{V} \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 -\\textbf{A}^{-1}\\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q\\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 (\\textbf{C}^{-1}+\\textbf{V}\\textbf{A}^{-1}\\textbf{U})^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{O} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\\\\\\\ =\u0026 \\begin{bmatrix}\\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V} \u0026 -\\textbf{U}-\\textbf{U}\\textbf{C}\\textbf{V}\\textbf{A}^{-1}\\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q\\end{bmatrix} \\begin{bmatrix}\\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 \\textbf{D}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{O} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\\\\\\\ =\u0026 \\begin{bmatrix} \\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V} \u0026 -\\textbf{U}\\textbf{C}\\textbf{D}\\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\ \\textbf{O} \u0026 \\textbf{D}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{O} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\\\\\\\ =\u0026 \\begin{bmatrix} \\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V} \u0026 -\\textbf{U}\\textbf{C} \\\\\\\\ \\textbf{O} \u0026 \\textbf{D}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{A}^{-1} \u0026 \\textbf{O} \\\\\\\\ \\textbf{V}\\textbf{A}^{-1} \u0026 \\textbf{C}^{-1} \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\ \\textbf{O} \u0026 \\textbf{I}_q \\end{bmatrix} \\\\\\\\ =\u0026 \\begin{bmatrix} \\textbf{I}_p \u0026 -\\textbf{U} \\\\\\\\ ? \u0026 ? \\end{bmatrix} \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{U} \\\\\\\\\\textbf{O} \u0026 \\textbf{I}_q\\end{bmatrix} = \\begin{bmatrix} \\textbf{I}_p \u0026 \\textbf{O} \\\\\\\\? \u0026 ?\\end{bmatrix} \\\\\\\\ \\Rightarrow \u0026 (\\textbf{A}+\\textbf{U}\\textbf{C}\\textbf{V})f(\\textbf{A},\\textbf{C},\\textbf{U},\\textbf{V}) = \\textbf{I}_p \\end{aligned}$$Punching Hole Technique The \u0026ldquo;observed\u0026rdquo; block matrix multiplication actually creates identity matrices and zero matrices as sub-matrices. The related technique introduced by Hua Loo-Keng is called \u0026ldquo;Punching Hole\u0026rdquo; Principle (打洞原理 in Chinese) where the zero matrices are the holes in block matrices.\nRank of Block Matrices Guttman rank additivity formula: If a block matrix $\\mathbf{P}$ of $2\\times 2$ sub-matrices with left-top sub-matrix $\\mathbf{A}$ nonsingular, then\n$$\\small\\begin{aligned} \\text{rank}(\\mathbf{P}) = \\text{rank}(\\begin{bmatrix} \\mathbf{A} \u0026 \\mathbf{B} \\\\\\\\ \\mathbf{C} \u0026 \\mathbf{D} \\end{bmatrix}) = \\text{rank}(\\mathbf{A}) + \\text{rank}(\\mathbf{D} - \\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}) \\end{aligned}$$ where $\\mathbf{D} - \\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}$ is $\\mathbf{A}$\u0026rsquo;s Schur Complement, written as $\\mathbf{P} / \\mathbf{A}$.\nProof:\n$$\\small\\begin{aligned} \\text{rank}(\\begin{bmatrix} \\mathbf{A} \u0026 \\mathbf{B} \\\\\\\\ \\mathbf{C} \u0026 \\mathbf{D} \\end{bmatrix}) \u0026= \\text{rank}(\\begin{bmatrix} \\mathbf{I} \u0026 \\mathbf{O} \\\\\\\\ -\\mathbf{C}\\mathbf{A}^{-1} \u0026 \\mathbf{I} \\end{bmatrix} \\begin{bmatrix} \\mathbf{A} \u0026 \\mathbf{B} \\\\\\\\ \\mathbf{C} \u0026 \\mathbf{D} \\end{bmatrix} \\begin{bmatrix} \\mathbf{I} \u0026 -\\mathbf{A}^{-1}\\mathbf{B} \\\\\\\\ \\mathbf{O} \u0026 \\mathbf{I} \\end{bmatrix}) \\\\\\\\ \u0026= \\text{rank}(\\begin{bmatrix} \\mathbf{A} \u0026 \\mathbf{B} \\\\\\\\ \\mathbf{O} \u0026 \\mathbf{D} - \\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B} \\end{bmatrix} \\begin{bmatrix} \\mathbf{I} \u0026 -\\mathbf{A}^{-1}\\mathbf{B} \\\\\\\\ \\mathbf{O} \u0026 \\mathbf{I} \\end{bmatrix}) \\\\\\\\ \u0026= \\text{rank}(\\begin{bmatrix} \\mathbf{A} \u0026 \\mathbf{O} \\\\\\\\ \\mathbf{O} \u0026 \\mathbf{D} - \\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B} \\end{bmatrix}) = \\text{rank}(\\mathbf{A}) + \\text{rank}(\\mathbf{D} - \\mathbf{C}\\mathbf{A}^{-1}\\mathbf{B}) \\end{aligned}$$$\\square$\nExtension: Block Matrix Rank Inequality Sylvester Inequality Sylvester Inequality: For any matrices $\\mathbf{A} \\in \\mathbb{R}^{m\\times n}, \\mathbf{B} \\in \\mathbb{R}^{n\\times k}$, then\n$$\\text{rank}(\\mathbf{AB}) \\ge \\text{rank}(\\mathbf{A}) + \\text{rank}(\\mathbf{B}) - n$$Proof: By Guttman rank additivity formula with $\\mathbf{A} = \\mathbf{I}_n$, then\n$$\\small \\begin{aligned}\\text{rank}(\\begin{bmatrix} \\mathbf{I}_n \u0026 \\mathbf{B} \\\\\\\\ \\mathbf{A} \u0026 \\mathbf{O}_{m\\times k}\\end{bmatrix}) \u0026= \\text{rank}(\\begin{bmatrix} \\mathbf{I}_{n} \u0026 \\mathbf{O} \\\\\\\\ -\\mathbf{A} \u0026 \\mathbf{I}_{m}\\end{bmatrix} \\begin{bmatrix} \\mathbf{I}_n \u0026 \\mathbf{B} \\\\\\\\ \\mathbf{A} \u0026 \\mathbf{O}_{m\\times k}\\end{bmatrix} \\begin{bmatrix} \\mathbf{I}_{n} \u0026 -\\mathbf{B} \\\\\\\\ \\mathbf{O} \u0026 \\mathbf{I}_{k}\\end{bmatrix}) \\\\\\\\ \u0026= \\text{rank}(\\begin{bmatrix} \\mathbf{I} \u0026 \\mathbf{O}_{n\\times k} \\\\\\\\ \\mathbf{O}_{m\\times n} \u0026 -\\mathbf{AB} \\end{bmatrix}) = \\text{rank}(\\mathbf{B}) + \\text{rank}(\\mathbf{AB}) = n + \\text{rank}(\\mathbf{AB}) \\end{aligned}$$Therefore,\n$$\\text{rank}(\\mathbf{AB}) = \\text{rank}(\\begin{bmatrix} \\mathbf{I}_n \u0026 \\mathbf{B} \\\\\\\\ \\mathbf{A} \u0026 \\mathbf{O}_{m\\times k}\\end{bmatrix}) - n \\ge \\text{rank}(\\mathbf{A}) + \\text{rank}(\\mathbf{B}) - n$$.\n$\\square$\nFrobenius Inequality Frobenius Inequality: For any matrices $\\mathbf{A} \\in \\mathbb{R}^{m\\times n}, \\mathbf{B} \\in \\mathbb{R}^{n\\times k}, \\mathbf{C} \\in \\mathbb{R}^{k\\times l}$, then\n$$\\text{rank}(\\mathbf{AB}) + \\text{rank}(\\mathbf{BC}) \\le \\text{rank}(\\mathbf{ABC}) + \\text{rank}(\\mathbf{B})$$Proof: Similar with Guttman rank additivity formula (but note that we don\u0026rsquo;t have inverse matrix of $\\mathbf{A}$),\n$$\\small \\begin{aligned}\\text{rank}(\\begin{bmatrix} \\mathbf{B} \u0026 \\mathbf{BC} \\\\\\\\ \\mathbf{AB} \u0026 \\mathbf{O}_{m\\times l}\\end{bmatrix}) \u0026= \\text{rank}(\\begin{bmatrix} \\mathbf{I}_{n} \u0026 \\mathbf{O} \\\\\\\\ -\\mathbf{A} \u0026 \\mathbf{I}_{m}\\end{bmatrix}\\begin{bmatrix} \\mathbf{B} \u0026 \\mathbf{BC} \\\\\\\\ \\mathbf{AB} \u0026 \\mathbf{O}_{m\\times l}\\end{bmatrix} \\begin{bmatrix} \\mathbf{I}_{k} \u0026 -\\mathbf{C} \\\\\\\\ \\mathbf{O} \u0026 \\mathbf{I}_{l}\\end{bmatrix}) = \\text{rank}(\\begin{bmatrix} \\mathbf{B} \u0026 \\mathbf{O}_{n\\times l} \\\\\\\\ \\mathbf{O}_{m\\times k} \u0026 -\\mathbf{ABC} \\end{bmatrix}) = \\text{rank}(\\mathbf{B}) + \\text{rank}(\\mathbf{ABC}) \\end{aligned}$$Therefore,\n$$\\text{rank}(\\mathbf{AB}) + \\text{rank}(\\mathbf{BC}) = \\text{rank}(\\begin{bmatrix} \\mathbf{O}_{n\\times k} \u0026 \\mathbf{BC} \\\\\\\\ \\mathbf{AB} \u0026 \\mathbf{O}_{m\\times l}\\end{bmatrix}) \\le \\text{rank}(\\begin{bmatrix} \\mathbf{B} \u0026 \\mathbf{BC} \\\\\\\\ \\mathbf{AB} \u0026 \\mathbf{O}_{m\\times l}\\end{bmatrix}) = \\text{rank}(\\mathbf{ABC}) + \\text{rank}(\\mathbf{B})$$$\\square$\n","date":"2025-03-08T00:00:00Z","image":"http://localhost:1313/p/punching-hole-technique/SMW-slide_hu_6e70bc4efc46de1c.jpg","permalink":"http://localhost:1313/p/punching-hole-technique/","title":"Punching Hole Technique"}]